<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados - AutoSimulate</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Adicionar fontes do Google -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Oswald:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Adicionar Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Chart.js para gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PapaParse para ler CSV -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
    <!-- Header ajustado para o padrão do CSS -->
    <header>
        <div class="header-content">
            <div class="logo">
                <span class="logo-text">AutoSimulate</span>
            </div>
            <nav class="nav-links">
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('questionnaire_page') }}">Simular Financiamento</a>
                <a href="{{ url_for('about_page') }}">Sobre Nós</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- Seção de Resultados -->
        <section class="page active">
            <div class="full-screen results">
                <div class="container">
                    <div class="section-title">
                        <h2>Resultados da Simulação</h2>
                        <p>Análise detalhada do seu financiamento com comparações e recomendações personalizadas</p>
                    </div>

                    <div class="dashboard">
                        <div class="dashboard-card">
                            <h3><i class="fas fa-file-invoice-dollar"></i> Resumo do Financiamento</h3>
                            <div id="simulationSummary" class="financial-data">
                                <div class="data-row">
                                    <span class="data-label">Valor do Veículo:</span>
                                    <span class="data-value" id="vehicleValueResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Entrada:</span>
                                    <span class="data-value" id="downPaymentResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Valor Financiado:</span>
                                    <span class="data-value" id="financedValueResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Parcela Mensal:</span>
                                    <span class="data-value" id="installmentValueResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Número de Parcelas:</span>
                                    <span class="data-value" id="installmentsResult">0</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Total Pago:</span>
                                    <span class="data-value" id="totalPaidResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Juros Totais:</span>
                                    <span class="data-value" id="totalInterestResult">R$ 0,00</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Comprometimento da Renda:</span>
                                    <span class="data-value" id="incomeCommitmentResult">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3><i class="fas fa-chart-pie"></i> Composição do Pagamento</h3>
                            <div class="chart-container">
                                <canvas id="paymentChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3><i class="fas fa-lightbulb"></i> Recomendações</h3>
                            <div id="recommendations" class="financial-data">
                                <div class="data-row">
                                    <span class="data-label">Status do Financiamento:</span>
                                    <span class="data-value" id="statusResult">-</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Nossa Análise:</span>
                                    <span class="data-value" id="analysisResult">-</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Sugestões:</span>
                                    <span class="data-value" id="suggestionsResult">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Comparação de Cenários -->
                    <div class="section-title" style="margin-top: 60px;">
                        <h3>Comparação de Cenários</h3>
                        <p>Analise diferentes opções de financiamento para tomar a melhor decisão</p>
                    </div>

                    <div class="comparison">
                        <div class="car-card">
                            <div class="car-image" id="currentCarImage">
                                <div class="car-badge" style="background-color: var(--ferrari-red);">Recomendado</div>
                            </div>
                            <div class="car-details">
                                <h4 id="currentCarTitle">Opção Atual</h4>
                                <p id="currentCarDescription">Configuração que você selecionou na simulação.</p>
                                <div class="specs">
                                    <div class="spec">
                                        <span class="spec-value" id="currentInstallment">-</span>
                                        <span class="spec-label">Parcela</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="currentTerm">-</span>
                                        <span class="spec-label">Prazo</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="currentTotal">-</span>
                                        <span class="spec-label">Total</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="car-card">
                            <div class="car-image" id="balancedCarImage">
                            </div>
                            <div class="car-details">
                                <h4 id="balancedCarTitle">Opção Balanceada</h4>
                                <p id="balancedCarDescription">Equilíbrio entre valor da parcela e prazo do financiamento.</p>
                                <div class="specs">
                                    <div class="spec">
                                        <span class="spec-value" id="balancedInstallment">-</span>
                                        <span class="spec-label">Parcela</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="balancedTerm">-</span>
                                        <span class="spec-label">Prazo</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="balancedTotal">-</span>
                                        <span class="spec-label">Total</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="car-card">
                            <div class="car-image" id="economicCarImage">
                            </div>
                            <div class="car-details">
                                <h4 id="economicCarTitle">Opção Econômica</h4>
                                <p id="economicCarDescription">Menor custo total com juros, ideal para quem pode pagar parcelas maiores.</p>
                                <div class="specs">
                                    <div class="spec">
                                        <span class="spec-value" id="economicInstallment">-</span>
                                        <span class="spec-label">Parcela</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="economicTerm">-</span>
                                        <span class="spec-label">Prazo</span>
                                    </div>
                                    <div class="spec">
                                        <span class="spec-value" id="economicTotal">-</span>
                                        <span class="spec-label">Total</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cronograma de Pagamento -->
                    <div class="form-container" style="margin-top: 50px;">
                        <h3 style="text-align: center; margin-bottom: 30px; color: var(--ferrari-white);">
                            <i class="fas fa-calendar-alt"></i> Cronograma de Pagamento (Primeiros 12 Meses)
                        </h3>
                        <div class="financial-data">
                            <div class="data-row" style="font-weight: bold; border-bottom: 2px solid var(--ferrari-red);">
                                <span class="data-label">Mês</span>
                                <span class="data-label">Parcela</span>
                                <span class="data-label">Juros</span>
                                <span class="data-label">Amortização</span>
                                <span class="data-label">Saldo Devedor</span>
                            </div>
                            <div id="paymentSchedule">
                                <!-- Cronograma será preenchido via JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Ações -->
                    <div class="result-actions" style="text-align: center; margin-top: 50px;">
                        <a href="{{ url_for('questionnaire_page') }}" class="cta-button">
                            <i class="fas fa-calculator"></i> Nova Simulação
                        </a>
                        <button onclick="window.print()" class="cta-button" style="background: transparent; margin-left: 15px;">
                            <i class="fas fa-print"></i> Imprimir Resultados
                        </button>
                        <button onclick="shareResults()" class="cta-button" style="background: transparent; margin-left: 15px;">
                            <i class="fas fa-share-alt"></i> Compartilhar
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer ajustado -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>AutoSimulate</h3>
                    <p>Sua plataforma confiável para simulação de financiamento de veículos.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Links Rápidos</h3>
                    <a href="{{ url_for('index') }}">Home</a>
                    <a href="{{ url_for('questionnaire_page') }}">Simular Financiamento</a>
                    <a href="{{ url_for('about_page') }}">Sobre Nós</a>
                </div>
                
                <div class="footer-column">
                    <h3>Contato</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>contato@autosimulate.com</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>(11) 9999-9999</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>São Paulo, SP</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Newsletter</h3>
                    <p>Receba novidades e dicas sobre financiamento.</p>
                    <form class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="Seu e-mail" required>
                        <button type="submit" class="newsletter-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 AutoSimulate - Todos os direitos reservados</p>
                <div class="footer-links">
                    <a href="#">Política de Privacidade</a>
                    <a href="#">Termos de Uso</a>
                    <a href="#">Cookies</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    
    <!-- Script para os resultados -->
    <script>
        // Dados de exemplo (em um cenário real, esses dados viriam do backend)
        let simulationData = {
            vehicleValue: 75000,
            downPayment: 15000,
            installments: 48,
            income: 6000,
            interestRate: 12,
            installmentValue: 1589.23,
            totalPaid: 76282.04,
            totalInterest: 16282.04
        };

        // Dados dos carros do CSV
        let carData = [];
        let selectedCar = null;

        // Inicializar resultados quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            loadCarData();
        });

        // Função para carregar dados do CSV
        function loadCarData() {
            // Em um cenário real, isso seria uma requisição ao backend
            // Para este exemplo, vamos simular o carregamento do CSV
            fetch('/static/data/carflix_listings.csv')
                .then(response => response.text())
                .then(csvText => {
                    // Parse do CSV usando PapaParse
                    Papa.parse(csvText, {
                        header: true,
                        complete: function(results) {
                            carData = results.data;
                            console.log('Dados dos carros carregados:', carData);
                            
                            // Selecionar um carro aleatório para demonstração
                            selectRandomCar();
                            
                            // Calcular e exibir resultados
                            calculateAndDisplayResults();
                        },
                        error: function(error) {
                            console.error('Erro ao carregar dados do CSV:', error);
                            // Em caso de erro, usar dados padrão
                            calculateAndDisplayResults();
                        }
                    });
                })
                .catch(error => {
                    console.error('Erro ao buscar arquivo CSV:', error);
                    // Em caso de erro, usar dados padrão
                    calculateAndDisplayResults();
                });
        }

        // Função para selecionar um carro aleatório
        function selectRandomCar() {
            if (carData.length > 0) {
                // Filtrar apenas carros com dados válidos
                const validCars = carData.filter(car => car.price && car.make && car.model);
                
                if (validCars.length > 0) {
                    // Selecionar um carro aleatório
                    const randomIndex = Math.floor(Math.random() * validCars.length);
                    selectedCar = validCars[randomIndex];
                    
                    // Atualizar dados de simulação com informações do carro selecionado
                    simulationData.vehicleValue = parseFloat(selectedCar.price) || simulationData.vehicleValue;
                    
                    // Calcular valor da parcela baseado no preço do carro
                    calculateInstallmentValue();
                    
                    console.log('Carro selecionado:', selectedCar);
                }
            }
        }

        // Função para calcular o valor da parcela
        function calculateInstallmentValue() {
            const financedValue = simulationData.vehicleValue - simulationData.downPayment;
            const monthlyRate = Math.pow(1 + simulationData.interestRate/100, 1/12) - 1;
            
            simulationData.installmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, simulationData.installments)) / (Math.pow(1 + monthlyRate, simulationData.installments) - 1);
            simulationData.totalPaid = simulationData.downPayment + (simulationData.installmentValue * simulationData.installments);
            simulationData.totalInterest = simulationData.totalPaid - simulationData.vehicleValue;
        }

        // Função para obter URL da imagem do carro
        function getCarImageUrl(car, optionType) {
            // Em um cenário real, isso buscaria da pasta car_images
            // Para este exemplo, vamos usar imagens baseadas no tipo de opção
            
            const imageBase = '/static/car_images/';
            
            if (car && car.image) {
                // Se o carro tem uma imagem específica no CSV
                return imageBase + car.image;
            } else if (car) {
                // Tentar construir um nome de arquivo baseado na marca e modelo
                const fileName = `${car.make.toLowerCase()}_${car.model.toLowerCase().replace(/\s+/g, '_')}.jpg`;
                return imageBase + fileName;
            } else {
                // Fallback para imagens padrão baseadas no tipo de opção
                const defaultImages = {
                    'current': 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                    'balanced': 'https://images.unsplash.com/photo-1503376780353-7e6692767b70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                    'economic': 'https://images.unsplash.com/photo-1494976388531-d1058494cdd8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80'
                };
                return defaultImages[optionType];
            }
        }

        // Função para calcular e exibir resultados
        function calculateAndDisplayResults() {
            const data = simulationData;
            
            // Calcular valores derivados
            const financedValue = data.vehicleValue - data.downPayment;
            const incomeCommitment = (data.installmentValue / data.income) * 100;
            
            // Atualizar resumo
            document.getElementById('vehicleValueResult').textContent = `R$ ${data.vehicleValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('downPaymentResult').textContent = `R$ ${data.downPayment.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('financedValueResult').textContent = `R$ ${financedValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('installmentValueResult').textContent = `R$ ${data.installmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('installmentsResult').textContent = data.installments;
            document.getElementById('totalPaidResult').textContent = `R$ ${data.totalPaid.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('totalInterestResult').textContent = `R$ ${data.totalInterest.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('incomeCommitmentResult').textContent = `${incomeCommitment.toFixed(2)}%`;
            
            // Destacar se comprometimento for alto
            if (incomeCommitment > 30) {
                document.getElementById('incomeCommitmentResult').classList.add('highlight');
            }
            
            // Atualizar informações do carro selecionado
            updateCarInformation();
            
            // Atualizar recomendações
            updateRecommendations(data, incomeCommitment);
            
            // Calcular opções alternativas
            calculateAlternativeOptions(data);
            
            // Criar gráfico
            createPaymentChart(data);
            
            // Gerar cronograma
            generatePaymentSchedule(data);
        }

        // Atualizar informações do carro selecionado
        function updateCarInformation() {
            if (selectedCar) {
                // Atualizar imagem do carro atual
                const currentCarImage = document.getElementById('currentCarImage');
                currentCarImage.style.backgroundImage = `url('${getCarImageUrl(selectedCar, 'current')}')`;
                
                // Atualizar título e descrição
                document.getElementById('currentCarTitle').textContent = `${selectedCar.make} ${selectedCar.model}`;
                document.getElementById('currentCarDescription').textContent = selectedCar.description || `Configuração que você selecionou na simulação.`;
                
                // Para as outras opções, selecionar carros diferentes
                updateAlternativeCarOptions();
            }
        }

        // Atualizar opções de carros alternativos
        function updateAlternativeCarOptions() {
            if (carData.length > 1) {
                // Filtrar carros válidos
                const validCars = carData.filter(car => car.price && car.make && car.model);
                
                // Selecionar carros diferentes para as opções balanceada e econômica
                const balancedCarIndex = Math.floor(Math.random() * validCars.length);
                let economicCarIndex;
                do {
                    economicCarIndex = Math.floor(Math.random() * validCars.length);
                } while (economicCarIndex === balancedCarIndex && validCars.length > 1);
                
                const balancedCar = validCars[balancedCarIndex];
                const economicCar = validCars[economicCarIndex];
                
                // Atualizar opção balanceada
                const balancedCarImage = document.getElementById('balancedCarImage');
                balancedCarImage.style.backgroundImage = `url('${getCarImageUrl(balancedCar, 'balanced')}')`;
                document.getElementById('balancedCarTitle').textContent = `${balancedCar.make} ${balancedCar.model}`;
                document.getElementById('balancedCarDescription').textContent = balancedCar.description || `Equilíbrio entre valor da parcela e prazo do financiamento.`;
                
                // Atualizar opção econômica
                const economicCarImage = document.getElementById('economicCarImage');
                economicCarImage.style.backgroundImage = `url('${getCarImageUrl(economicCar, 'economic')}')`;
                document.getElementById('economicCarTitle').textContent = `${economicCar.make} ${economicCar.model}`;
                document.getElementById('economicCarDescription').textContent = economicCar.description || `Menor custo total com juros, ideal para quem pode pagar parcelas maiores.`;
            }
        }

        // Atualizar recomendações
        function updateRecommendations(data, incomeCommitment) {
            let status = 'Aprovado';
            let analysis = 'Financiamento dentro dos parâmetros recomendados.';
            let suggestions = 'Mantenha o pagamento em dia e considere antecipar parcelas para reduzir juros.';
            
            if (incomeCommitment > 40) {
                status = 'Atenção';
                analysis = 'O valor da parcela compromete uma parte significativa da sua renda.';
                suggestions = 'Considere aumentar a entrada ou buscar um prazo maior para reduzir as parcelas.';
            } else if (incomeCommitment > 30) {
                status = 'Moderado';
                analysis = 'O financiamento está no limite do recomendado para sua renda.';
                suggestions = 'Avalie se consegue manter esse compromisso por todo o período.';
            }
            
            document.getElementById('statusResult').textContent = status;
            document.getElementById('analysisResult').textContent = analysis;
            document.getElementById('suggestionsResult').textContent = suggestions;
            
            // Aplicar cor ao status
            const statusElement = document.getElementById('statusResult');
            if (status === 'Aprovado') {
                statusElement.style.color = '#00ff00';
            } else if (status === 'Atenção') {
                statusElement.style.color = '#ff2800';
            } else {
                statusElement.style.color = '#ffcc00';
            }
        }

        // Calcular opções alternativas
        function calculateAlternativeOptions(data) {
            const financedValue = data.vehicleValue - data.downPayment;
            const monthlyRate = Math.pow(1 + data.interestRate/100, 1/12) - 1;
            
            // Opção atual
            document.getElementById('currentInstallment').textContent = `R$ ${data.installmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('currentTerm').textContent = `${data.installments} meses`;
            document.getElementById('currentTotal').textContent = `R$ ${data.totalPaid.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            
            // Opção balanceada (36 meses)
            const balancedInstallments = 36;
            const balancedInstallmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, balancedInstallments)) / (Math.pow(1 + monthlyRate, balancedInstallments) - 1);
            const balancedTotal = data.downPayment + (balancedInstallmentValue * balancedInstallments);
            
            document.getElementById('balancedInstallment').textContent = `R$ ${balancedInstallmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('balancedTerm').textContent = `${balancedInstallments} meses`;
            document.getElementById('balancedTotal').textContent = `R$ ${balancedTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            
            // Opção econômica (24 meses)
            const economicInstallments = 24;
            const economicInstallmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, economicInstallments)) / (Math.pow(1 + monthlyRate, economicInstallments) - 1);
            const economicTotal = data.downPayment + (economicInstallmentValue * economicInstallments);
            
            document.getElementById('economicInstallment').textContent = `R$ ${economicInstallmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('economicTerm').textContent = `${economicInstallments} meses`;
            document.getElementById('economicTotal').textContent = `R$ ${economicTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        }

        // Criar gráfico de composição do pagamento
        function createPaymentChart(data) {
            const ctx = document.getElementById('paymentChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Valor do Veículo', 'Juros Totais'],
                    datasets: [{
                        data: [data.vehicleValue, data.totalInterest],
                        backgroundColor: [
                            'rgba(255, 255, 255, 0.8)',
                            'rgba(255, 40, 0, 0.8)'
                        ],
                        borderColor: [
                            'rgba(255, 255, 255, 1)',
                            'rgba(255, 40, 0, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'white',
                                font: {
                                    family: 'Montserrat'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed;
                                    return `R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Gerar cronograma de pagamento
        function generatePaymentSchedule(data) {
            const scheduleContainer = document.getElementById('paymentSchedule');
            const financedValue = data.vehicleValue - data.downPayment;
            const monthlyRate = Math.pow(1 + data.interestRate/100, 1/12) - 1;
            
            let balance = financedValue;
            let scheduleHTML = '';
            
            for (let month = 1; month <= 12; month++) {
                const interest = balance * monthlyRate;
                const amortization = data.installmentValue - interest;
                balance -= amortization;
                
                scheduleHTML += `
                    <div class="data-row">
                        <span class="data-label">${month}</span>
                        <span class="data-label">R$ ${data.installmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                        <span class="data-label">R$ ${interest.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                        <span class="data-label">R$ ${amortization.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                        <span class="data-label">R$ ${balance.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                    </div>
                `;
            }
            
            scheduleContainer.innerHTML = scheduleHTML;
        }

        // Função para compartilhar resultados
        function shareResults() {
            if (navigator.share) {
                navigator.share({
                    title: 'Resultados da Simulação - AutoSimulate',
                    text: 'Confira os resultados da minha simulação de financiamento na AutoSimulate!',
                    url: window.location.href
                })
                .then(() => console.log('Conteúdo compartilhado com sucesso'))
                .catch((error) => console.log('Erro ao compartilhar:', error));
            } else {
                alert('Seu navegador não suporta a função de compartilhamento nativa. Copie o link manualmente.');
            }
        }
    </script>

    <style>
        .car-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }
        
        .data-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            padding: 10px 0;
            border-bottom: 1px solid rgba(100, 100, 100, 0.2);
        }
        
        .data-row:last-child {
            border-bottom: none;
        }
        
        .highlight {
            color: var(--ferrari-red) !important;
            font-weight: 700;
        }
        
        .car-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
            border-radius: 8px 8px 0 0;
        }
    </style>
</body>
</html>