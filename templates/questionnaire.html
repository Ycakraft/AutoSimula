<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simular Financiamento - AutoSimulate</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Adicionar fontes do Google -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Oswald:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Adicionar Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- PapaParse para ler CSV -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
    <!-- Header ajustado para o padrão do CSS -->
    <header>
        <div class="header-content">
            <div class="logo">
                <span class="logo-text">AutoSimulate</span>
            </div>
            <nav class="nav-links">
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('questionnaire_page') }}" class="active">Simular Financiamento</a>
                <a href="{{ url_for('about_page') }}">Sobre Nós</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- Seção de Questionário -->
        <section class="page active">
            <div class="full-screen questionnaire">
                <div class="container">
                    <div class="section-title">
                        <h2>Simulação de Financiamento</h2>
                        <p>Preencha os campos abaixo para simular seu financiamento de forma precisa e detalhada.</p>
                    </div>

                    <div class="form-container">
                        <form id="financingForm" onsubmit="event.preventDefault(); simulateFinancing();">
                            <!-- Seletor de Veículo -->
                            <div class="form-group">
                                <label for="vehicleSelect">Selecione o Veículo:</label>
                                <select id="vehicleSelect" class="form-control" required onchange="updateVehicleDetails()">
                                    <option value="">Selecione um veículo</option>
                                    <!-- As opções serão preenchidas via JavaScript -->
                                </select>
                            </div>

                            <!-- Detalhes do Veículo Selecionado -->
                            <div id="vehicleDetails" style="display: none; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                                <div class="vehicle-preview">
                                    <div class="vehicle-image-container">
                                        <img id="vehicleImage" src="" alt="Imagem do veículo" style="width: 100%; max-height: 150px; object-fit: cover; border-radius: 8px;">
                                    </div>
                                    <div class="vehicle-info">
                                        <h4 id="vehicleTitle">-</h4>
                                        <p id="vehicleDescription">-</p>
                                        <div class="vehicle-specs">
                                            <span id="vehicleYear">-</span> • 
                                            <span id="vehicleMileage">-</span> • 
                                            <span id="vehicleFuel">-</span>
                                        </div>
                                        <div class="vehicle-price">
                                            <strong id="vehiclePrice">-</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="downPayment">Entrada (R$):</label>
                                <input type="number" id="downPayment" class="form-control" required min="0" step="0.01" placeholder="Ex: 10000.00">
                            </div>
                            
                            <div class="form-group">
                                <label for="installments">Número de Parcelas:</label>
                                <select id="installments" class="form-control" required>
                                    <option value="">Selecione o prazo</option>
                                    <option value="12">12 meses</option>
                                    <option value="24">24 meses</option>
                                    <option value="36">36 meses</option>
                                    <option value="48">48 meses</option>
                                    <option value="60">60 meses</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="income">Renda Mensal (R$):</label>
                                <input type="number" id="income" class="form-control" required min="1000" step="0.01" placeholder="Ex: 5000.00">
                            </div>

                            <div class="form-group">
                                <label for="interestRate">Taxa de Juros (% ao ano):</label>
                                <div class="slider-container">
                                    <input type="range" id="interestRate" class="slider" min="5" max="30" step="0.5" value="12">
                                    <div class="slider-value" id="interestRateValue">12%</div>
                                </div>
                            </div>
                            
                            <button type="submit" class="cta-button" style="width: 100%; margin-top: 20px;">
                                <i class="fas fa-calculator"></i> Simular Financiamento
                            </button>
                        </form>
                    </div>

                    <!-- Resultados da Simulação -->
                    <div id="results" class="form-container" style="display: none; margin-top: 40px;">
                        <div class="section-title">
                            <h3>Resultado da Simulação</h3>
                            <p>Análise detalhada do seu financiamento</p>
                        </div>
                        
                        <div class="dashboard">
                            <div class="dashboard-card">
                                <h3><i class="fas fa-file-invoice-dollar"></i> Resumo do Financiamento</h3>
                                <div id="simulationResults" class="financial-data">
                                    <!-- Os resultados serão inseridos aqui pelo JavaScript -->
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <h3><i class="fas fa-chart-pie"></i> Composição do Pagamento</h3>
                                <div class="chart-container" id="paymentChart">
                                    <!-- Gráfico será inserido aqui -->
                                    <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: var(--ferrari-gray);">
                                        <i class="fas fa-chart-pie fa-3x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="comparison">
                            <div class="car-card">
                                <div class="car-image" id="conservativeCarImage">
                                </div>
                                <div class="car-details">
                                    <h4 id="conservativeCarTitle">Opção Conservadora</h4>
                                    <p id="conservativeCarDescription">Financiamento com parcelas menores e prazo estendido, ideal para quem busca menor comprometimento da renda.</p>
                                    <div class="specs">
                                        <div class="spec">
                                            <span class="spec-value" id="conservativeInstallment">-</span>
                                            <span class="spec-label">Parcela</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="conservativeTerm">-</span>
                                            <span class="spec-label">Prazo</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="conservativeTotal">-</span>
                                            <span class="spec-label">Total</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="car-card">
                                <div class="car-image" id="balancedCarImage">
                                </div>
                                <div class="car-details">
                                    <h4 id="balancedCarTitle">Opção Balanceada</h4>
                                    <p id="balancedCarDescription">Equilíbrio entre valor da parcela e prazo do financiamento, oferecendo uma relação custo-benefício ideal.</p>
                                    <div class="specs">
                                        <div class="spec">
                                            <span class="spec-value" id="balancedInstallment">-</span>
                                            <span class="spec-label">Parcela</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="balancedTerm">-</span>
                                            <span class="spec-label">Prazo</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="balancedTotal">-</span>
                                            <span class="spec-label">Total</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="car-card">
                                <div class="car-image" id="aggressiveCarImage">
                                </div>
                                <div class="car-details">
                                    <h4 id="aggressiveCarTitle">Opção Agressiva</h4>
                                    <p id="aggressiveCarDescription">Financiamento com prazo reduzido e parcelas maiores, minimizando o custo total com juros.</p>
                                    <div class="specs">
                                        <div class="spec">
                                            <span class="spec-value" id="aggressiveInstallment">-</span>
                                            <span class="spec-label">Parcela</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="aggressiveTerm">-</span>
                                            <span class="spec-label">Prazo</span>
                                        </div>
                                        <div class="spec">
                                            <span class="spec-value" id="aggressiveTotal">-</span>
                                            <span class="spec-label">Total</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="cta-button" onclick="window.print()">
                                <i class="fas fa-print"></i> Imprimir Simulação
                            </button>
                            <button class="cta-button" onclick="resetForm()" style="background: transparent; margin-left: 15px;">
                                <i class="fas fa-redo"></i> Nova Simulação
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer ajustado -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>AutoSimulate</h3>
                    <p>Sua plataforma confiável para simulação de financiamento de veículos.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Links Rápidos</h3>
                    <a href="{{ url_for('index') }}">Home</a>
                    <a href="{{ url_for('questionnaire_page') }}">Simular Financiamento</a>
                    <a href="{{ url_for('about_page') }}">Sobre Nós</a>
                </div>
                
                <div class="footer-column">
                    <h3>Contato</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>contato@autosimulate.com</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>(11) 9999-9999</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>São Paulo, SP</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Newsletter</h3>
                    <p>Receba novidades e dicas sobre financiamento.</p>
                    <form class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="Seu e-mail" required>
                        <button type="submit" class="newsletter-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 AutoSimulate - Todos os direitos reservados</p>
                <div class="footer-links">
                    <a href="#">Política de Privacidade</a>
                    <a href="#">Termos de Uso</a>
                    <a href="#">Cookies</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    
    <!-- Script para a simulação -->
    <script>
        // Dados dos carros do CSV
        let carData = [];
        let selectedCar = null;

        // Inicializar quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            loadCarData();
            
            // Atualizar valor do slider de juros
            document.getElementById('interestRate').addEventListener('input', function() {
                document.getElementById('interestRateValue').textContent = this.value + '%';
            });
        });
        
        // Função para carregar dados do CSV
        function loadCarData() {
            // Em um cenário real, isso seria uma requisição ao backend
            // Para este exemplo, vamos simular o carregamento do CSV
            fetch('/static/data/carflix_listings.csv')
                .then(response => response.text())
                .then(csvText => {
                    // Parse do CSV usando PapaParse
                    Papa.parse(csvText, {
                        header: true,
                        complete: function(results) {
                            carData = results.data.filter(car => car.price && car.make && car.model);
                            console.log('Dados dos carros carregados:', carData);
                            
                            // Preencher o seletor de veículos
                            populateVehicleSelect();
                        },
                        error: function(error) {
                            console.error('Erro ao carregar dados do CSV:', error);
                            // Em caso de erro, usar dados de exemplo
                            carData = [
                                {
                                    make: 'Volkswagen',
                                    model: 'Golf',
                                    year: '2020',
                                    price: '85000',
                                    mileage: '25000',
                                    fuel: 'Gasolina',
                                    image: 'golf.jpg',
                                    description: 'Carro esportivo com ótimo desempenho e conforto.'
                                },
                                {
                                    make: 'Ford',
                                    model: 'Focus',
                                    year: '2019',
                                    price: '65000',
                                    mileage: '35000',
                                    fuel: 'Flex',
                                    image: 'focus.jpg',
                                    description: 'Carro familiar com bom espaço interno e economia.'
                                },
                                {
                                    make: 'Chevrolet',
                                    model: 'Onix',
                                    year: '2021',
                                    price: '70000',
                                    mileage: '15000',
                                    fuel: 'Flex',
                                    image: 'onix.jpg',
                                    description: 'Carro compacto com ótimo custo-benefício.'
                                }
                            ];
                            populateVehicleSelect();
                        }
                    });
                })
                .catch(error => {
                    console.error('Erro ao buscar arquivo CSV:', error);
                    // Em caso de erro, usar dados de exemplo
                    carData = [
                        {
                            make: 'Volkswagen',
                            model: 'Golf',
                            year: '2020',
                            price: '85000',
                            mileage: '25000',
                            fuel: 'Gasolina',
                            image: 'golf.jpg',
                            description: 'Carro esportivo com ótimo desempenho e conforto.'
                        }
                    ];
                    populateVehicleSelect();
                });
        }

        // Preencher o seletor de veículos
        function populateVehicleSelect() {
            const vehicleSelect = document.getElementById('vehicleSelect');
            
            // Limpar opções existentes (exceto a primeira)
            while (vehicleSelect.options.length > 1) {
                vehicleSelect.remove(1);
            }
            
            // Adicionar opções para cada carro
            carData.forEach((car, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${car.make} ${car.model} ${car.year} - R$ ${parseFloat(car.price).toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
                vehicleSelect.appendChild(option);
            });
        }

        // Atualizar detalhes do veículo selecionado
        function updateVehicleDetails() {
            const vehicleSelect = document.getElementById('vehicleSelect');
            const vehicleDetails = document.getElementById('vehicleDetails');
            const selectedIndex = vehicleSelect.value;
            
            if (selectedIndex) {
                selectedCar = carData[selectedIndex];
                
                // Atualizar informações do veículo
                document.getElementById('vehicleTitle').textContent = `${selectedCar.make} ${selectedCar.model} ${selectedCar.year}`;
                document.getElementById('vehicleDescription').textContent = selectedCar.description || 'Veículo selecionado para financiamento.';
                document.getElementById('vehicleYear').textContent = selectedCar.year;
                document.getElementById('vehicleMileage').textContent = selectedCar.mileage ? `${selectedCar.mileage} km` : '-';
                document.getElementById('vehicleFuel').textContent = selectedCar.fuel || '-';
                document.getElementById('vehiclePrice').textContent = `R$ ${parseFloat(selectedCar.price).toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
                
                // Atualizar imagem do veículo
                const vehicleImage = document.getElementById('vehicleImage');
                vehicleImage.src = getCarImageUrl(selectedCar);
                vehicleImage.alt = `${selectedCar.make} ${selectedCar.model}`;
                
                // Exibir detalhes do veículo
                vehicleDetails.style.display = 'block';
            } else {
                // Ocultar detalhes se nenhum veículo estiver selecionado
                vehicleDetails.style.display = 'none';
                selectedCar = null;
            }
        }

        // Função para obter URL da imagem do carro
        function getCarImageUrl(car, optionType = 'default') {
            // Em um cenário real, isso buscaria da pasta car_images
            // Para este exemplo, vamos usar imagens baseadas no tipo de opção
            
            const imageBase = '/static/car_images/';
            
            if (car && car.image) {
                // Se o carro tem uma imagem específica no CSV
                return imageBase + car.image;
            } else if (car) {
                // Tentar construir um nome de arquivo baseado na marca e modelo
                const fileName = `${car.make.toLowerCase()}_${car.model.toLowerCase().replace(/\s+/g, '_')}.jpg`;
                return imageBase + fileName;
            } else {
                // Fallback para imagens padrão baseadas no tipo de opção
                const defaultImages = {
                    'default': 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                    'conservative': 'https://images.unsplash.com/photo-1494976388531-d1058494cdd8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                    'balanced': 'https://images.unsplash.com/photo-1503376780353-7e6692767b70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                    'aggressive': 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80'
                };
                return defaultImages[optionType];
            }
        }

        // Função para simular o financiamento
        function simulateFinancing() {
            // Validar se um veículo foi selecionado
            if (!selectedCar) {
                alert('Por favor, selecione um veículo antes de simular o financiamento!');
                return;
            }
            
            // Obter valores do formulário
            const vehicleValue = parseFloat(selectedCar.price);
            const downPayment = parseFloat(document.getElementById('downPayment').value);
            const installments = parseInt(document.getElementById('installments').value);
            const income = parseFloat(document.getElementById('income').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value);
            
            // Validar entrada
            if (downPayment >= vehicleValue) {
                alert('A entrada não pode ser maior ou igual ao valor do veículo!');
                return;
            }
            
            if (downPayment < 0) {
                alert('A entrada não pode ser negativa!');
                return;
            }
            
            // Calcular valor financiado
            const financedValue = vehicleValue - downPayment;
            
            // Calcular taxa de juros mensal
            const monthlyRate = Math.pow(1 + interestRate/100, 1/12) - 1;
            
            // Calcular valor da parcela (Sistema Price)
            const installmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, installments)) / (Math.pow(1 + monthlyRate, installments) - 1);
            
            // Calcular total pago
            const totalPaid = downPayment + (installmentValue * installments);
            
            // Calcular juros totais
            const totalInterest = totalPaid - vehicleValue;
            
            // Verificar se a parcela compromete mais de 30% da renda
            const incomeCommitment = (installmentValue / income) * 100;
            
            // Exibir resultados
            document.getElementById('simulationResults').innerHTML = `
                <div class="data-row">
                    <span class="data-label">Veículo:</span>
                    <span class="data-value">${selectedCar.make} ${selectedCar.model}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Valor do Veículo:</span>
                    <span class="data-value">R$ ${vehicleValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Entrada:</span>
                    <span class="data-value">R$ ${downPayment.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Valor Financiado:</span>
                    <span class="data-value">R$ ${financedValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Parcela Mensal:</span>
                    <span class="data-value">R$ ${installmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Número de Parcelas:</span>
                    <span class="data-value">${installments}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Total Pago:</span>
                    <span class="data-value">R$ ${totalPaid.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Juros Totais:</span>
                    <span class="data-value">R$ ${totalInterest.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Comprometimento da Renda:</span>
                    <span class="data-value ${incomeCommitment > 30 ? 'highlight' : ''}">${incomeCommitment.toFixed(2)}%</span>
                </div>
            `;
            
            // Calcular opções alternativas
            calculateAlternativeOptions(vehicleValue, downPayment, income, interestRate);
            
            // Atualizar informações dos carros nas opções alternativas
            updateAlternativeCarOptions();
            
            // Exibir seção de resultados
            document.getElementById('results').style.display = 'block';
            
            // Rolar até os resultados
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Calcular opções alternativas
        function calculateAlternativeOptions(vehicleValue, downPayment, income, interestRate) {
            const financedValue = vehicleValue - downPayment;
            const monthlyRate = Math.pow(1 + interestRate/100, 1/12) - 1;
            
            // Opção conservadora (60 meses)
            const conservativeInstallments = 60;
            const conservativeInstallmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, conservativeInstallments)) / (Math.pow(1 + monthlyRate, conservativeInstallments) - 1);
            const conservativeTotal = downPayment + (conservativeInstallmentValue * conservativeInstallments);
            
            // Opção balanceada (36 meses)
            const balancedInstallments = 36;
            const balancedInstallmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, balancedInstallments)) / (Math.pow(1 + monthlyRate, balancedInstallments) - 1);
            const balancedTotal = downPayment + (balancedInstallmentValue * balancedInstallments);
            
            // Opção agressiva (24 meses)
            const aggressiveInstallments = 24;
            const aggressiveInstallmentValue = financedValue * (monthlyRate * Math.pow(1 + monthlyRate, aggressiveInstallments)) / (Math.pow(1 + monthlyRate, aggressiveInstallments) - 1);
            const aggressiveTotal = downPayment + (aggressiveInstallmentValue * aggressiveInstallments);
            
            // Atualizar cards com as opções
            document.getElementById('conservativeInstallment').textContent = `R$ ${conservativeInstallmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('conservativeTerm').textContent = `${conservativeInstallments} meses`;
            document.getElementById('conservativeTotal').textContent = `R$ ${conservativeTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            
            document.getElementById('balancedInstallment').textContent = `R$ ${balancedInstallmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('balancedTerm').textContent = `${balancedInstallments} meses`;
            document.getElementById('balancedTotal').textContent = `R$ ${balancedTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            
            document.getElementById('aggressiveInstallment').textContent = `R$ ${aggressiveInstallmentValue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
            document.getElementById('aggressiveTerm').textContent = `${aggressiveInstallments} meses`;
            document.getElementById('aggressiveTotal').textContent = `R$ ${aggressiveTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        }

        // Atualizar informações dos carros nas opções alternativas
        function updateAlternativeCarOptions() {
            if (carData.length > 1) {
                // Filtrar carros válidos (excluindo o carro selecionado)
                const validCars = carData.filter(car => car !== selectedCar && car.price && car.make && car.model);
                
                if (validCars.length >= 2) {
                    // Selecionar carros diferentes para as opções conservadora e balanceada
                    const conservativeCar = validCars[0];
                    const balancedCar = validCars[1];
                    
                    // Para a opção agressiva, usar o carro selecionado ou outro carro
                    const aggressiveCar = validCars.length > 2 ? validCars[2] : selectedCar;
                    
                    // Atualizar opção conservadora
                    const conservativeCarImage = document.getElementById('conservativeCarImage');
                    conservativeCarImage.style.backgroundImage = `url('${getCarImageUrl(conservativeCar, 'conservative')}')`;
                    document.getElementById('conservativeCarTitle').textContent = `${conservativeCar.make} ${conservativeCar.model}`;
                    document.getElementById('conservativeCarDescription').textContent = conservativeCar.description || 'Financiamento com parcelas menores e prazo estendido, ideal para quem busca menor comprometimento da renda.';
                    
                    // Atualizar opção balanceada
                    const balancedCarImage = document.getElementById('balancedCarImage');
                    balancedCarImage.style.backgroundImage = `url('${getCarImageUrl(balancedCar, 'balanced')}')`;
                    document.getElementById('balancedCarTitle').textContent = `${balancedCar.make} ${balancedCar.model}`;
                    document.getElementById('balancedCarDescription').textContent = balancedCar.description || 'Equilíbrio entre valor da parcela e prazo do financiamento, oferecendo uma relação custo-benefício ideal.';
                    
                    // Atualizar opção agressiva
                    const aggressiveCarImage = document.getElementById('aggressiveCarImage');
                    aggressiveCarImage.style.backgroundImage = `url('${getCarImageUrl(aggressiveCar, 'aggressive')}')`;
                    document.getElementById('aggressiveCarTitle').textContent = `${aggressiveCar.make} ${aggressiveCar.model}`;
                    document.getElementById('aggressiveCarDescription').textContent = aggressiveCar.description || 'Financiamento com prazo reduzido e parcelas maiores, minimizando o custo total com juros.';
                }
            }
        }
        
        // Função para resetar o formulário
        function resetForm() {
            document.getElementById('financingForm').reset();
            document.getElementById('interestRateValue').textContent = '12%';
            document.getElementById('vehicleDetails').style.display = 'none';
            document.getElementById('results').style.display = 'none';
            selectedCar = null;
        }
    </script>

    <style>
        .vehicle-preview {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }
        
        .vehicle-image-container {
            flex: 0 0 150px;
        }
        
        .vehicle-info {
            flex: 1;
        }
        
        .vehicle-specs {
            color: var(--ferrari-gray);
            font-size: 0.9rem;
            margin: 5px 0;
        }
        
        .vehicle-price {
            color: var(--ferrari-red);
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        .car-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
            border-radius: 8px 8px 0 0;
        }
        
        .highlight {
            color: var(--ferrari-red) !important;
            font-weight: 700;
        }
        
        @media (max-width: 768px) {
            .vehicle-preview {
                flex-direction: column;
            }
            
            .vehicle-image-container {
                flex: 0 0 auto;
                width: 100%;
            }
        }
    </style>
</body>
</html>